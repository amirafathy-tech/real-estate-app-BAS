sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/ui/model/json/JSONModel","sap/m/Dialog","sap/m/List","sap/m/StandardListItem","sap/m/Button"],function(t,e,n,i,o,s,a,l){"use strict";return t.extend("real.estate.custom.recustom.controller.View1",{onInit:function(){const t={Buildings:[{ID:"1a2b3c4d",name:"Building A",location:"Downtown"},{ID:"2b1c4d5e",name:"Building B",location:"Uptown"}],Units:[{ID:"unit1",buildingID:"1a2b3c4d",name:"Unit 101",status:"available"},{ID:"unit2",buildingID:"1a2b3c4d",name:"Unit 102",status:"reserved"},{ID:"unit3",buildingID:"2b1c4d5e",name:"Unit 201",status:"available"}]};const e=new i(t);this.getView().setModel(e)},onFileChange:function(t){const e=t.getParameter("files")[0];if(!e)return;const n=new FileReader;n.onload=t=>{const e=this.byId("siteMapImage");e.setSrc(t.target.result);e.setVisible(true);setTimeout(()=>{const t=e.getDomRef();if(t&&!t._clickAttached){t.addEventListener("click",this.onImageClick.bind(this));t._clickAttached=true}},200)};n.readAsDataURL(e)},onUploadPress:function(){const t=this.byId("fileUploader");if(!t.getValue()){e.show("Please choose an image first.");return}e.show("Image uploaded successfully.")},onImageClick:function(t){const n=t.currentTarget;const i=n.getBoundingClientRect();const o=t.clientX-i.left;const s=t.clientY-i.top;const a=o/i.width*100;const l=s/i.height*100;console.log(`Clicked at: X: ${a.toFixed(2)}%, Y: ${l.toFixed(2)}%`);const c=[{name:"Building A",buildingID:"1a2b3c4d",xMin:10,xMax:30,yMin:20,yMax:40},{name:"Building B",buildingID:"2b1c4d5e",xMin:40,xMax:60,yMin:10,yMax:30}];const d=c.find(t=>a>=t.xMin&&a<=t.xMax&&l>=t.yMin&&l<=t.yMax);if(d){this.showUnitsPopup(d.buildingID,d.name);e.show(`Selected ${d.name}`)}else{e.show("No building at this point.")}},onBuildingSelect:function(t){const e=t.getParameter("listItem").getBindingContext();const n=e.getProperty("ID");const i=e.getProperty("name");this.showUnitsPopup(n,i)},showUnitsPopup:function(t,e){const n=this.getView().getModel();const c=n.getProperty("/Units");const d=c.filter(e=>e.buildingID===t);const r=new i({Units:d});const u=new s({mode:"SingleSelectMaster",selectionChange:t=>{console.log("Unit selected from popup");const n=t.getParameter("listItem").getBindingContext("unitModel").getObject();console.log("Selected unit:",n);this.onUnitSelect(n,g,u,e,r)},items:{path:"unitModel>/Units",template:new a({title:"{unitModel>name}",description:"{unitModel>status}",highlight:"{= ${unitModel>status} === 'reserved' ? 'Error' : 'Success' }",type:"Active"})}});const g=new o({title:`Units in ${e}`,content:u,beginButton:new l({text:"Close",press:()=>g.close()}),afterClose:()=>g.destroy()});g.setModel(r,"unitModel");g.open()},onUnitSelect:function(t,e,n,i,o){const c=new s({mode:"SingleSelectMaster",selectionChange:s=>{const a=s.getParameter("listItem").getTitle();this.handleUnitAction(a,t,e,n,i,o)},items:[new a({title:"Create Reservation",type:"Active"}),new a({title:"Go to Payment",type:"Active"})]});e.setTitle(`Actions for ${t.name}`);e.removeAllContent();e.addContent(c);e.setEndButton(new l({text:"Back",press:()=>{e.setTitle(`Units in ${i}`);e.removeAllContent();e.addContent(n);e.setEndButton(null)}}))},handleUnitAction:function(t,n,i,o,s,a){if(t==="Create Reservation"){e.show(`Reservation for ${n.name} created (static)`);const t=this.getView().getModel();const l=t.getProperty("/Units");const c=l.findIndex(t=>t.ID===n.ID);if(c!==-1){l[c].status="reserved";t.setProperty("/Units",l);const e=a.getProperty("/Units");const i=e.findIndex(t=>t.ID===n.ID);if(i!==-1){e[i].status="reserved";a.setProperty("/Units",e)}}i.setTitle(`Units in ${s}`);i.removeAllContent();i.addContent(o);i.setEndButton(null)}else if(t==="Go to Payment"){e.show(`Navigating to payment for ${n.name} (static)`);i.setTitle(`Units in ${s}`);i.removeAllContent();i.addContent(o);i.setEndButton(null)}}})});
//# sourceMappingURL=View1.controller.js.map